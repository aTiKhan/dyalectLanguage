var success = 0;
var failures = 0;

func run(test) {
    if test() {
        success = success + 1
    } else {
        failures = failures + 1
    }
}

func assert(fn, x, y) {
    if x != y {
        print (fn + ": Assert failed: Expected: "  + x + ", got: " + y);
        return false;
    }
    return true;
}

///////////////////////////////////////////////////////////////
func whileTest1()
{
    var n = 100;
    var x = while n > 0 {
        if n == 33 {
            break n
        }
        n = n - 1;
    }

    assert(this, x, 33);
}

func whileTest2()
{
    var n = 100;
    var x = while n > 0 {
        if n == 33 {
            break
        }
        n = n - 1;
    }

    if !x {
        x = 42
    }

    assert(this, x, 42);
}

func fizzbuzzTest() {
    var n = 1;
    var acc = "";

    while n < 11 {
        if n % 15 == 0 {
            acc = acc + "fizzbuzz";
        } else if n % 3 == 0 {
            acc = acc + "fizz";
        } else if n % 5 == 0 {
            acc = acc + "buzz";
        } else {
            acc = acc + n;
        }

        n = n + 1;
    }

    assert(this, "12fizz4buzzfizz78fizzbuzz", acc);
}

func iterTest() {
    var acc = 0;
    func iter(n) {
        if n == 0 {
            0
        } else {
            acc = acc + 1;
            iter(n - 1)
        }
    }

    iter(10);
    assert(this, 10, acc);
}


run(whileTest1);
run(whileTest2);
run(fizzbuzzTest);
run(iterTest);


///////////////////////////////////////////////////////////////
print("-------------------------------------------------------");
print("Total tests: " + (success + failures));
print("Success: " + success);
print("Failures: " + failures);
print("-------------------------------------------------------");
